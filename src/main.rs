#![allow(dead_code, mutable_transmutes, non_camel_case_types, non_snake_case,
         non_upper_case_globals, unused_assignments, unused_mut)]
#![feature(const_raw_ptr_to_usize_cast, extern_types, main)]

mod sha3;
mod round5;
mod utils;

use rustc_serialize::hex::{FromHex,ToHex};

fn main() {
    let keygen_coins = "7C9935A0B07694AA0C6D10E4DB6B1ADD2FD81A25CCB148032DCD739936737F2D8626ED79D451140800E03B59B956F8210E556067407D13DC90FA9E8B872BFB8F147C03F7A5BEBBA406C8FAE1874D7F13C80EFE79A3A9A874CC09FE76F6997615".from_hex().unwrap();

    let mut pk = vec![0; round5::PUBLICKEYBYTES];
    let mut sk = vec![0; round5::SECRETKEYBYTES];

    unsafe {
    round5::crypto_encrypt_keypair(pk.as_mut_ptr(), sk.as_mut_ptr(),
                                   keygen_coins.as_ptr());
    }

    assert_eq!(pk.to_hex(), "7c9935a0b07694aa0c6d10e4db6b1add2fd81a25ccb148032dcd739936737f2d17005777975fe4ea1348cd4dfd79322f34724cdfdf6f1c116de492014157400b0141809b00d547cff0d397d3890b9cee2694f7d354d16128c1df883c25b786b887d9569c9af62006cabfb8a0656f43c323526e0984fbcdbb01175e60c7f5a4b25f3aa2d16a152fbacbe3e8f6d2b006c087136740cb2d3741500bf77f7fab680f36cced8f2826fd789a0f7b7c97dc45be0c0c49225772a87efa830c4d1d1ae55166dd83971ae5a10c97197c96db51bf7adfa75c4e61d58f8e32cab9e2693dc3eeb04e7cd96bd464af8d854440502fa122a04c5f9264316c10bff8ba3016a9ed32ecaf96c4b0be9f0b32ece3ce93026b812207b11daea92647f1ac589e5b42d04d6cd7f2ec1f5fdacf40f22c72448e88d2a9141fa1ac883353ae491c4545921824fbf4bb0e6e4cf407a3a82c2cbbee31121ea89ea5143a4b1f5c2edffbac2c3d70e83d7bfec0cd15a519340b30a71090c12c2b9b1ecde94501facb340547126fb2f36e61a42bed1da000c29a782ec5f55fb435c2b2287d6c57e73f26f101348b87d915746a526821fae0927fdb6e4dbdd4427d1c65818bb0c042b21b0f4dc72d612259dc3e345de0da30a44a413c8a6a99fb956da750eee9137d214e80a5ed34411469f7bd4310299ff2c662014d53b17c07a8ccc96ae5cc3c51212fc72ef233d5e9f739e53063d0741a3ee9e98bd25b5af59b959bb8f0fe69c30b2a6cfafddbda70794393b1312cc80e5e3413d76ebcfeaba2df855228cdc7e3bd4d008418a175b49e5aadb1d815707c49f4e8e770bbaa35943acbb534763c7c16d2530fc25286b576784d90e17a9ef5c7bb6696144a224f3f07c4f72ae17e031e473b4f24381496d43a319da83553ee042d8c3cd048c1bb95010022c0af4a566583fde93073992f4309b55138c47cff27bb228b86e320dfc35fcb8c0ce3e067c0ddbb789dfa99a61bb74c8cfd5c8d84e3b96dd817f8ea882e60f12c7711a4fdc0198bfea9be643b28af4be4baf6b48b2fce7793b94dcdbaabbb5baffbef52964a71a115ef89aae11990de7b449068cbe541126de0f643ef6b5587dec43736483fbda9252971f04cc3967ecf396bc600aa6c06e0c060dd5585608ce5fa7fce3a4c68a06f87dba8697e2f61054f2152914514f2c1dfab2ac05474185fac07b7fb30e3b93126e4074329a80c09d9b06388d487ab0336a9e68b945284bdfae370b36f82426874721467d13403d726fdc7c0fb17e1a4d47f4b9e5920bf401fd40dbd6832637e028d3aaae5ac84782356350910cd465315a4a8c50983415ac53c731eeba8222d05f3e03ef4ca829cdf8b33fad0a5aca1b891727207f8dce6625fba6a0e06d4fb4e2094afccfb369038edfa9bebae3935b65c3bf2b4d10c0161c8f21e1651bdb5d199401975ddcd72620cb3c1600823a8022358b94fe987da07908ef1dfe5fd166e4866888ce9b3c962de3180903f23869928f9b15f6680ccfd3a9837587202e9f25f0c46076a00e811d10f4ebb6cd932f847edacfe61a3252ea01f8a9d1155a9a7cb1ebe8834477202ed40ef0ebfcb4ad48203736b96d440c4a9557018bf99ae16331d16e2d7c553a04e4591e631d012d58710b171a73d4a1dbd780332cf5ae6446b69701c18656643b7ebae2249b48912399867ac9e12b00b4c64221aa869deb072caea4ee2807a8e6221222cc1d5871652c8a3a3e31f218055e22512f7fd61e8e6fa94436063966b9691ada5bb40bdb3aec2c7f15f8c31c97bc0dd23f1107a79336d395ca26b3bc57e7ceab090e82875ac82e9a6897a2bfa4257764f5c4c184b6ecab56ac712c2e97037ea0050b2e8d3d0898ed891c51e3b353a7b1f57b58b93c8bb1a184dd900");

    assert_eq!(sk.to_hex(), "8626ed79d451140800e03b59b956f8210e556067407d13dc90fa9e8b872bfb8f147c03f7a5bebba406c8fae1874d7f13c80efe79a3a9a874cc09fe76f69976157c9935a0b07694aa0c6d10e4db6b1add2fd81a25ccb148032dcd739936737f2d17005777975fe4ea1348cd4dfd79322f34724cdfdf6f1c116de492014157400b0141809b00d547cff0d397d3890b9cee2694f7d354d16128c1df883c25b786b887d9569c9af62006cabfb8a0656f43c323526e0984fbcdbb01175e60c7f5a4b25f3aa2d16a152fbacbe3e8f6d2b006c087136740cb2d3741500bf77f7fab680f36cced8f2826fd789a0f7b7c97dc45be0c0c49225772a87efa830c4d1d1ae55166dd83971ae5a10c97197c96db51bf7adfa75c4e61d58f8e32cab9e2693dc3eeb04e7cd96bd464af8d854440502fa122a04c5f9264316c10bff8ba3016a9ed32ecaf96c4b0be9f0b32ece3ce93026b812207b11daea92647f1ac589e5b42d04d6cd7f2ec1f5fdacf40f22c72448e88d2a9141fa1ac883353ae491c4545921824fbf4bb0e6e4cf407a3a82c2cbbee31121ea89ea5143a4b1f5c2edffbac2c3d70e83d7bfec0cd15a519340b30a71090c12c2b9b1ecde94501facb340547126fb2f36e61a42bed1da000c29a782ec5f55fb435c2b2287d6c57e73f26f101348b87d915746a526821fae0927fdb6e4dbdd4427d1c65818bb0c042b21b0f4dc72d612259dc3e345de0da30a44a413c8a6a99fb956da750eee9137d214e80a5ed34411469f7bd4310299ff2c662014d53b17c07a8ccc96ae5cc3c51212fc72ef233d5e9f739e53063d0741a3ee9e98bd25b5af59b959bb8f0fe69c30b2a6cfafddbda70794393b1312cc80e5e3413d76ebcfeaba2df855228cdc7e3bd4d008418a175b49e5aadb1d815707c49f4e8e770bbaa35943acbb534763c7c16d2530fc25286b576784d90e17a9ef5c7bb6696144a224f3f07c4f72ae17e031e473b4f24381496d43a319da83553ee042d8c3cd048c1bb95010022c0af4a566583fde93073992f4309b55138c47cff27bb228b86e320dfc35fcb8c0ce3e067c0ddbb789dfa99a61bb74c8cfd5c8d84e3b96dd817f8ea882e60f12c7711a4fdc0198bfea9be643b28af4be4baf6b48b2fce7793b94dcdbaabbb5baffbef52964a71a115ef89aae11990de7b449068cbe541126de0f643ef6b5587dec43736483fbda9252971f04cc3967ecf396bc600aa6c06e0c060dd5585608ce5fa7fce3a4c68a06f87dba8697e2f61054f2152914514f2c1dfab2ac05474185fac07b7fb30e3b93126e4074329a80c09d9b06388d487ab0336a9e68b945284bdfae370b36f82426874721467d13403d726fdc7c0fb17e1a4d47f4b9e5920bf401fd40dbd6832637e028d3aaae5ac84782356350910cd465315a4a8c50983415ac53c731eeba8222d05f3e03ef4ca829cdf8b33fad0a5aca1b891727207f8dce6625fba6a0e06d4fb4e2094afccfb369038edfa9bebae3935b65c3bf2b4d10c0161c8f21e1651bdb5d199401975ddcd72620cb3c1600823a8022358b94fe987da07908ef1dfe5fd166e4866888ce9b3c962de3180903f23869928f9b15f6680ccfd3a9837587202e9f25f0c46076a00e811d10f4ebb6cd932f847edacfe61a3252ea01f8a9d1155a9a7cb1ebe8834477202ed40ef0ebfcb4ad48203736b96d440c4a9557018bf99ae16331d16e2d7c553a04e4591e631d012d58710b171a73d4a1dbd780332cf5ae6446b69701c18656643b7ebae2249b48912399867ac9e12b00b4c64221aa869deb072caea4ee2807a8e6221222cc1d5871652c8a3a3e31f218055e22512f7fd61e8e6fa94436063966b9691ada5bb40bdb3aec2c7f15f8c31c97bc0dd23f1107a79336d395ca26b3bc57e7ceab090e82875ac82e9a6897a2bfa4257764f5c4c184b6ecab56ac712c2e97037ea0050b2e8d3d0898ed891c51e3b353a7b1f57b58b93c8bb1a184dd900");

    println!("hi");
}
